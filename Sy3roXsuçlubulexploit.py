import socket

def scan_ports(ip, ports):
    open_ports = []
    for port in ports:
        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
            sock.settimeout(1)
            result = sock.connect_ex((ip, port))
            if result == 0:
                open_ports.append(port)
    return open_ports

def check_for_suspicious_activity(open_ports):
    suspicious_ports = {80, 443, 8080}  # Şüpheli portlar
    if set(open_ports) & suspicious_ports:
        return True
    return False

def main():
    target_ip = input("Hedef IP adresini girin: ")
    target_ports = range(1, 1025)  # Taramak istediğiniz port aralığı

    open_ports = scan_ports(target_ip, target_ports)

    if open_ports:
        print("Açık Portlar:")
        for port in open_ports:
            print(port)
        
        if check_for_suspicious_activity(open_ports):
            print("Şüpheli faaliyet tespit edildi.")
        else:
            print("Şüpheli faaliyet tespit edilmedi.")
    else:
        print("Açık port bulunamadı.")

if __name__ == "__main__":
    main()
